<!DOCTYPE html>
<html>
<head>
    <title>index</title>
    <link href="content/svg.css" rel="stylesheet" />
</head>
<body>
    <svg width="800" height="500">
        <svg style="width: 100%; height: 100%; overflow: hidden;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
            <defs></defs>
            <g class="svg-draggable">
                <g>
                    <g>
                        <path d="M50.397 155 L 63.388 147.5" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,-14.397672,39.96875)"></path>
                        <path d="M50.397 55 L 63.388 62.5" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,-14.397672,23.34375)"></path>
                        <path d="M137 5 L 137 20" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,0,15.03125)"></path>
                        <path d="M223.603 55 L 210.612 62.5" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,14.397672,23.34375)"></path>
                        <path d="M223.603 155 L 210.612 147.5" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,14.397672,39.96875)"></path>
                    </g>
                    <g>
                        <path d="M37 105 L 47 105" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,-16.625,31.65625)"></path>
                        <path d="M87 18.397 L 92 27.058" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,-8.3125,17.258578)"></path>
                        <path d="M187 18.397 L 182 27.058" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,8.3125,17.258578)"></path>
                        <path d="M237 105 L 227 105" stroke="#2e2e2e" stroke-width="0.5" fill="none" transform="matrix(1,0,0,1,16.625,31.65625)"></path>
                    </g>
                </g>
                <g>
                    <path d="M27.34 199.969 C 13.195 175.47 7.601 146.143 11.733 118.158 15.866 90.174 29.698 63.715 50.319 44.351 70.941 24.986 98.215 12.842 126.404 10.475 154.593 8.108 183.511 15.533 207.073 31.188 230.635 46.842 248.686 70.623 257.428 97.527" stroke="green" stroke-width="10" fill="none"></path>
                    <path d="M257.428 97.527 C 262.891 114.342 264.779 132.309 262.931 149.892" stroke="#ffff00" stroke-width="10" fill="none"></path>
                    <path d="M262.931 149.892 C 261.083 167.475 255.501 184.657 246.66 199.969" stroke="#ff0000" stroke-width="10" fill="none"></path>
                </g>
                <g id="pressureneedle" transform="matrix(-0.866025,0.5,-0.5,-0.866025,323.973605,186.504034)">
                    <path d="M243.625 136.656 L 137 133.656 137 139.656Z" stroke="#000000" stroke-width="0.5" fill="#000000"></path>
                    <circle cx="137" cy="136.65625" r="6" stroke="#000000" fill="#000000"></circle>
                </g>
                <g>
                    <g transform="matrix(1,0,0,1,-27.388053,47.46875)">
                        <path d="M77.373 125.5 L 88.373 125.5 88.373 143.5 77.373 143.5Z" stroke="none" fill="none"></path>
                        <path d="M77.373 125.5 L 88.373 125.5 88.373 143.5 77.373 143.5Z" stroke="none" fill="none"></path>
                        <text style="font:12px Arial,Helvetica,sans-serif;" x="79.37341226347257" y="138.5" stroke="none" fill="#2e2e2e">0</text>
                    </g>
                    <g transform="matrix(1,0,0,1,-27.388053,15.84375)">
                        <path d="M76.302 66.5 L 103.302 66.5 103.302 84.5 76.302 84.5Z" stroke="none" fill="none"></path>
                        <path d="M76.302 66.5 L 103.302 66.5 103.302 84.5 76.302 84.5Z" stroke="none" fill="none"></path>
                        <text style="font:12px Arial,Helvetica,sans-serif;" x="78.3016154937481" y="79.5" stroke="none" fill="#2e2e2e">0.25</text>
                    </g>
                    <g transform="matrix(1,0,0,1,0,0.03125)">
                        <path d="M126.5 37 L 147.5 37 147.5 55 126.5 55Z" stroke="none" fill="none"></path>
                        <path d="M126.5 37 L 147.5 37 147.5 55 126.5 55Z" stroke="none" fill="none"></path>
                        <text style="font:12px Arial,Helvetica,sans-serif;" x="128.5" y="50" stroke="none" fill="#2e2e2e">0.5</text>
                    </g>
                    <g transform="matrix(1,0,0,1,27.388053,15.84375)">
                        <path d="M170.698 66.5 L 197.698 66.5 197.698 84.5 170.698 84.5Z" stroke="none" fill="none"></path>
                        <path d="M170.698 66.5 L 197.698 66.5 197.698 84.5 170.698 84.5Z" stroke="none" fill="none"></path>
                        <text style="font:12px Arial,Helvetica,sans-serif;" x="172.6983845062519" y="79.49999999999997" stroke="none" fill="#2e2e2e">0.75</text>
                    </g>
                    <g transform="matrix(1,0,0,1,27.388053,47.46875)">
                        <path d="M185.627 125.5 L 196.627 125.5 196.627 143.5 185.627 143.5Z" stroke="none" fill="none"></path>
                        <path d="M185.627 125.5 L 196.627 125.5 196.627 143.5 185.627 143.5Z" stroke="none" fill="none"></path>
                        <text style="font:12px Arial,Helvetica,sans-serif;" x="187.6265877365274" y="138.5" stroke="none" fill="#2e2e2e">1</text>
                    </g>
                </g>
                <path d="M0 0 L 274 0 274 210 0 210Z" stroke="#fff" fill="#fff" stroke-opacity="0" fill-opacity="0"></path>
            </g>
        </svg>
    </svg>
    <svg height="400" width="400">
        <g id="rotatethis" transform="matrix(1,0,0,1,200,200)">
            <path d="M200 200 L 250 300" stroke="red" stroke-width="5"></path>
            <circle cx="300" cy="300" r="6" stroke="black"></circle>
        </g>
        <!--<g id="rotatethis" transform="rotate(0,200,200)">
            <path d="M200 200 L 250 300" stroke="red" stroke-width="5"></path>
            <circle cx="300" cy="300" r="6" stroke="black"></circle>
        </g>-->
    </svg>
    <div draggable="true" style="position: absolute; top: 500px; left: 100px;">
        <p>Hello World!</p>
    </div>
    <div id="xmouse"></div>
    <div id="ymouse"></div>
    <script src="scripts/svgdraggable.js"></script>
    <script>
        window.onload = function () {
            new SVGDraggable.Drag();

            var tid = setInterval(mycode, 2000);
            var rotate = 0;
            function mycode() {
                var transformElement = document.getElementById('rotatethis');
                var pressureNeedle = document.getElementById('pressureneedle');
                var svg = document.querySelector('svg');
                var matrix = svg.createSVGMatrix();
                matrix.a = Math.cos(rotate);
                matrix.b = Math.sin(rotate);
                matrix.c = -Math.sin(rotate);
                matrix.d = Math.cos(rotate);
                matrix.e = 200;
                matrix.f = 200;
                transformElement.transform.baseVal.getItem(0).setRotate(rotate, 200, 200);
                pressureNeedle.transform.baseVal.getItem(0).setRotate(rotate, 137, 136.656);
                if (rotate < 360) {
                    rotate += 30;
                }
                else {
                    rotate = 0;
                }
            }
        };

        function onPressureSVGMousemove(event, element) {

            var svg = element.closest('svg');
            var offset = svg.getBoundingClientRect();
            var startPoint = cursorPoint(event, svg);
            var xDis = startPoint.x - offset.left;
            var yDis = startPoint.y - offset.top;

            // Find your root SVG element
            // Create an SVGPoint for future math

            element.addEventListener('mousemove', function (event) {
                //var loc = cursorPoint(event, svg);
                //// Use loc.x and loc.y here
                //if (!element.transform.baseVal.length) {
                //    var newTransform = svg.createSVGTransform();
                //    newTransform.setTranslate(offset.left, offset.top);
                //    element.transform.baseVal.appendItem(newTransform);
                //} else {
                //    element.transform.baseVal.getItem(0).setTranslate(loc.x - xDis, loc.y - yDis);
                //}
                moveSVGObject(event, element, svg);
            });
        }
        // Get point in global SVG space
        function cursorPoint(event, svg) {
            var pt = svg.createSVGPoint();
            pt.x = event.clientX; pt.y = event.clientY;
            return pt.matrixTransform(svg.getScreenCTM().inverse());
        }
        function moveSVGObject(event, element, svg, offset) {
            var loc = cursorPoint(event, svg);
            // Use loc.x and loc.y here
            if (!element.transform.baseVal.length) {
                var newTransform = svg.createSVGTransform();
                newTransform.setTranslate(offset.left, offset.top);
                element.transform.baseVal.appendItem(newTransform);
            } else {
                element.transform.baseVal.getItem(0).setTranslate(loc.x - xDis, loc.y - yDis);
            }
        }
    </script>
</body>
</html>